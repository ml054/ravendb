<div class="modal-dialog" role="document" id="newDatabase" data-bind="css: { 'modal-lg': showWideDialog(), 'modal-sm': !showWideDialog() }">
    <form data-bind="submit: createDatabase" autocomplete="off">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" data-bind="click: close" class="close" data-dismiss="modal" aria-label="Close"><i aria-hidden="true" class="icon-cancel"></i></button>
                <h4 class="modal-title" id="newDatabaseLabel">New database</h4>
            </div>
            <div class="modal-body">
                <div class="modal-settings-panel">
                    <div class="modal-settings-panel-main">
                        <div class="form-group" data-bind="validationElement: databaseModel.name">
                            <h3>NAME</h3>
                            <input type="text" id="resourceName" data-bind="textInput: databaseModel.name" autofocus class="form-control">
                        </div>
                        
                        <div class="form-group" data-bind="validationElement: databaseModel.replicationFactor">
                            <p>Replication factor</p>
                            <input type="number" data-bind="numericInput: databaseModel.replicationFactor" class="form-control">
                        </div>
                        
                        <p class="bg-warning padding padding-xs" data-bind="visible: showReplicationFactorWarning">With replication factor set to 1 data won't be replicated.</p>
                        
                        <h3>BUNDLES</h3>
                        <div class="settings-group" data-bind="foreach: getAvailableBundles()">
                            <div class="checkbox settings-item" data-bind="css: { 'active': $root.advancedBundleConfigurationVisible() === name }">
                                <input class="styled" type="checkbox" data-bind="checked: $root.databaseModel.selectedBundles, checkedValue: name, attr: { id: 'bundle_' + $index() }">
                                <label data-bind="text: displayName, attr: { 'for': 'bundle_' + $index() }"></label>
                                <button type="button" class="btn pull-right btn-toggle"
                                        data-bind="visible: hasAdvancedConfiguration, click: $root.showAdvancedConfigurationFor.bind($root, name), css: { 'btn-danger': validationGroup && !validationGroup.isValid() }">
                                    <i data-bind="attr: { 'class' : validationGroup && !validationGroup.isValid() ? 'icon-danger' : 'icon-settings' }"></i>
                                </button>
                            </div>
                        </div>

                        <button type="button"
                                data-bind="click: showAdvancedConfiguration, attr: { 'class': 'btn btn-block btn-toggle ' + (databaseModel.advancedValidationGroup.isValid() ? 'btn-info' : 'btn-danger')  }">
                            <i data-bind="attr: { 'class': databaseModel.advancedValidationGroup.isValid() ? 'icon-settings' : 'icon-danger' }"></i><span>Advanced</span>
                        </button>
                    </div>
                    <div class="modal-settings-panel-slideout">
                        <div data-bind="if: bundlesEnabled.encryption()">
                            <div class="encryption" data-bind="template: { name: 'create-db-encryption' }, visible: advancedVisibility.encryption()">
                            </div>
                        </div>
                        <div data-bind="if: bundlesEnabled.replication()">
                            <div class="replication" data-bind="template: { name: 'create-db-replication' }, visible: advancedVisibility.replication()">
                            </div>
                        </div>
                        <div>
                            <div class="advanced" data-bind="template: { name: 'create-db-advanced' }, visible: advancedConfigurationVisible()">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="submit" class="btn btn-success btn-block" data-bind="css: { 'btn-spinner': spinners.create }, disable: spinners.create"><i class="icon-plus"></i><span>Create</span></button>
            </div>
        </div>
    </form>
</div>


<script type="text/html" id="create-db-advanced">
    <h3>ADVANCED</h3>
    <div class="form-group row" data-bind="validationElement: databaseModel.dataPath">
        <div class="col-md-4">
            <label class="control-label">Path</label>
        </div>
        <div class="col-md-8">
            <input type="text" class="form-control" data-bind="textInput: databaseModel.dataPath, attr: { placeholder: '~/' + databaseModel.name() }" />
        </div>
    </div>
    <div class="form-group row" data-bind="validationElement: databaseModel.journalsPath">
        <div class="col-md-4">
            <label class="control-label">Journals</label>
        </div>
        <div class="col-md-8">
            <input type="text" class="form-control" data-bind="textInput: databaseModel.journalsPath, attr: { placeholder: '~/' + databaseModel.name() }" />
        </div>
    </div>
    <div class="form-group row" data-bind="validationElement: databaseModel.indexesPath">
        <div class="col-md-4">
            <label class="control-label">Indexes</label>
        </div>
        <div class="col-md-8">
            <input type="text" class="form-control" data-bind="textInput: databaseModel.indexesPath, attr: { placeholder: indexesPathPlaceholder() }" />
        </div>
    </div>
    <div class="form-group row" data-bind="validationElement: databaseModel.tempPath">
        <div class="col-md-4">
            <label class="control-label">Temp</label>
        </div>
        <div class="col-md-8">
            <input type="text" class="form-control" data-bind="textInput: databaseModel.tempPath, attr: { placeholder: '~/' + databaseModel.name() }" />
        </div>
    </div>
    <div class="checkbox">
        <input id="check-incremental-backup" class="styled" type="checkbox" data-bind="checked: databaseModel.incrementalBackup">
        <label for="check-incremental-backup">Incremental Backup</label>
    </div>
    <div data-bind="visible: databaseModel.incrementalBackup()">
        <div class="form-group row">
            <div class="col-md-4">
                <label>Alert timeout</label>
            </div>
            <div class="col-md-8">
                <div class="btn-group btn-block">
                    <button type="button" class="btn btn-block dropdown-toggle" data-toggle="dropdown" title="Sets the span of time allowed before issuing an alert for missing backup (in hours).">
                        <span data-bind="text: $root.pluralize(databaseModel.incrementalBackupSettings.alertTimeout(), 'hour', 'hours')"></span>
                        <span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu" role="menu" data-bind="foreach: databaseModel.alertTimeoutOptions">
                        <li><a href="#" data-bind="text: $data, click: $root.databaseModel.setAlertTimeout.bind($root.databaseModel, $data)"></a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="form-group row">
            <div class="col-md-4">
                <label>Alert recurring timeout</label>
            </div>
            <div class="col-md-8">
                <div class="btn-group btn-block">
                    <button type="button" class="btn btn-block dropdown-toggle" data-toggle="dropdown" title="Sets the span of time allowed before issuing multiple alerts on the same missed backup (in days).">
                        <span data-bind="text: $root.pluralize(databaseModel.incrementalBackupSettings.alertRecurringTimeout(), 'day', 'days')"></span>
                        <span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu" role="menu" data-bind="foreach: databaseModel.alertRecurringTimeoutOptions">
                        <li><a href="#" data-bind="text: $data, click: $root.databaseModel.setRecurringAlertTimeout.bind($root.databaseModel, $data)"></a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</script>


<script type="text/html" id="create-db-replication">
    Replication
</script>

<script type="text/html" id="create-db-encryption">
    <div class="form-group row" data-bind="validationElement: databaseModel.encryption.key">
        <div class="col-md-6">
            <label class="control-label">
                Select Key <small class="text-muted">(Base64 Encoding)</small>
            </label>
        </div>
        <div class="col-md-6">
            <div class="input-group">
                <input type="text" class="form-control" placeholder="Key" autocomplete="off"
                       data-bind="textInput: databaseModel.encryption.key">
                <span class="input-group-btn">
                    <button class="btn btn-default" type="button" data-bind="click: generateEncryptionKey">
                        <i class="icon-reset"></i>
                    </button>
                </span>
            </div>
        </div>
        <div class="col-sm-12">
            <p class="bg-info padding padding-sm small">
                <i class="icon-warning"></i> Save this key in a safe place. If you lose this key you could lose access to your data.
            </p>
        </div>
    </div>
</script>